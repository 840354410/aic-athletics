#### 介绍
本项目是一个体育竞赛报名项目，使用了 uni-app  开发，兼容了小程序和h5；
1. 该项目使用 uni-app  进行开发，使用到了 Vite + Vue3 + Ts + pinia + Unocss + Uview-plus + Axios+ UniCrazyRouter  等技术；
2. 使用 UniCrazyRouter  进行统一路由拦截；
3. 使用 Unocss  动态生成全局原子 css;
4. 代码格式使用 Eslint的 Prettier  进行规范约束；
5. 通过 pinia  实现各组件之间数据共享；
6. 使用 axios-miniprogram-adapter  适配器插件兼容微信小程序请求；
7. 二次封装 Axios ，对请求体和响应体进行额外处理，实现请求自动添加 Token 、错误统一处理等逻辑；
8. 实现微信授权登录、自定义分享、微信支付等功能；
#### 特性
- 🚀 使用vue3/vite4/pinia/axios等主流框架开发
- 🚀 引入Uview-plus组件库，开箱即用
- 💪 引入Eslint/Prettier，统一前端代码风格
- 💪 引入lint-staged/husky/commitlint/commitizen/standard-version，统一代码提交规范，自动生成版本发布日志
- 💪 使用Pinia，并支持持久化存储
- 💪 提供Koa-mock本地mock服务
- 💪 支持axios取消请求（基于requestTask.abort()实现）

## 注意！！！
> 请求的baseUrl配置在/src/utils/config.ts里面，在h5中是不需要带域名的，但是小程序需要，在config.ts里面都做好配置了，可以根据该文件内ENV的变量控制访问本地/正式服务器
> 使用了Pinia + 数据持久化，在/src/store/auth.ts中的auth是给h5使用的授权方法，在开发环境下可以注释掉跳转授权页面，正式必须跳，已做好配置
> 因为h5的签名算法要求url的参数按照字段名的ASCII 码从小到大排序（字典序）且所有参数名均为小写字符，所以使用了路由拦截，把所有url的参数都重置了一下，然后在页面中通过createLowercasePropertyProxy这个函数把访问options的参数都转成小写，这样就能通过大写的字符访问到变量了

#### 项目依赖

| 功能 | 依赖库 |
| --- | --- |
| 组件库 | [Uview-plus](https://uiadmin.net/uview-plus/components/intro.html) |
| 原子css | [Unocss](https://unocss.dev/integrations/vite)
| 路由（导航守卫） | [UniCrazyRouter](https://ext.dcloud.net.cn/plugin?id=1658) |
| 网络请求（支持取消请求） | `axios`  [axios-miniprogram-adapter] |
| 代码规范 | `Eslint` `Prettier` |
| 提交规范 | `lint-staged` `husky` `commitlint` `commitizen` |
| 发布日志 | `standard-version` |
| 状态管理 | `pinia`（自定义插件实现持久化） |

#### 项目目录
```
pages主包页面，目前只放了登录页面和授权完的加载中间页
athletics分包，活动赛事模块
```
#### 项目结构
```shell
uniapp-vue3-fant-ts
├─ .env.development----------------------------------环境变量文件dev时生效，VITE_BASEURL为接口地址
├─ .env.production-----------------------------------环境变量文件build时生效，VITE_BASEURL为接口地址
├─ .eslintignore-------------------------------------eslint豁免校验的配置，配置的文件免于eslint校验
├─ .eslintrc.js--------------------------------------eslint配置，指定eslint校验规则
├─ .gitignore
├─ .husky--------------------------------------------git hooks，此处配置了pre-commit和commit-msg两个
├─ .prettierrc---------------------------------------prettier配置，指定prettier校验规则
├─ .vscode-------------------------------------------vscode配置，实现保存的时候格式化
├─ CHANGELOG.md--------------------------------------版本发布日志
├─ README.md
├─ commitlint.config.js------------------------------commitlint配置文件
├─ index.html
├─ koa-mock------------------------------------------基于koa实现的本地mock项目
│    ├─ api------------------------------------------将接口返回的json放在此目录，接口即为api/文件名
├─ package.json
├─ src-----------------------------------------------项目资源目录
│    ├─ App.vue--------------------------------------uni的主组件，所有页面都是在App.vue下进行切换的，是页面入口文件
│    ├─ api------------------------------------------API文件，用于集中管理接口
│    ├─ assets---------------------------------------资源文件，用于存放字体/图片等
          └─ fonts-----------------------------------阿里矢量图标
          └─ images----------------------------------静态资源图片
     ├─ athletics------------------------------------赛事报名分包模块，文件模块和主包一致
│    ├─ http-----------------------------------------axios拦截器，用于自定义请求和响应拦截
│    ├─ components-----------------------------------全局通用组件
│    ├─ config---------------------------------------全局通用组件
          └─ images.ts-------------------------------阿里云资源链接
│    ├─ main.ts--------------------------------------入口文件，主要作用是初始化vue实例、定义全局组件
│    ├─ manifest.json--------------------------------应用的配置文件，用于指定应用的名称、图标、权限等
│    ├─ model----------------------------------------API接口用到的typescript模型，集中管理
│    ├─ pages----------------------------------------业务页面
│    ├─ router---------------------------------------UniCrazyRouter插件配置，导航守卫
│    ├─ pages.json-----------------------------------页面全局配置，决定页面文件的路径、窗口样式、原生的导航栏、底部的原生tabbar 等
│    ├─ router---------------------------------------路由配置，导航守卫
│    ├─ static---------------------------------------资源文件，图片等
│    ├─ store----------------------------------------pinia配置，持久化存储
│    │    └─ auth.ts---------------------------------用户信息，授权，通用信息等
│    │    └─ persist.ts------------------------------持久化插件
│    │    └─ sport.ts--------------------------------报名模块
│    ├─ styles---------------------------------------全局样式库
│    │    └─ uview-plus------------------------------
│    │    │     └─ index.scss------------------------在uview-plus/index.scss的基础上去除了flex.scss，color使用/src/styles/color.scss里面的
│    │    └─ color.scss------------------------------css主题样式
│    │    └─ index.scss------------------------------全局通用的css
│    │    └─ reset.scss------------------------------重写了一些uview-plus组件库的样式
│    │    └─ var.scss--------------------------------css主题变量
│    ├─ types.d.ts-----------------------------------typescript的声明文件
│    ├─ uni.scss-------------------------------------全局scss变量，无需引入可以直接使用
│    └─ uni_modules----------------------------------uni-app插件
│           └─ tob-use-------------------------------基于vue3封装的组合式hooks，适用于uniapp
│    ├─ utils----------------------------------------通用工具方法
│    │    └─ addinterceptor.ts-----------------------uni接口拦截配置
│    │    └─ auth.ts---------------------------------获取token
│    │    └─ commonUtil.ts---------------------------通用方法，移植了fant-mini-plus组件库
│    │    └─ config.ts-------------------------------请求baseUrl配置
│    │    └─ coordtransform.ts-----------------------不同标准的地理经纬度转换
│    │    └─ debounce.ts-----------------------------防抖
│    │    └─ index.ts--------------------------------导入了当前目录utils所有工具方法
│    │    └─ pattern.ts------------------------------正则pattern
│    │    └─ reg.ts----------------------------------正则reg
│    │    └─ requestTasks.ts-------------------------promise任务队列封装
│    │    └─ throttle.ts-----------------------------节流
│    │    └─ util.ts---------------------------------自定义通用方法，后面有通用方法都放这里
│    │    └─ validate.ts-----------------------------自定义验证方法
│    │    └─ wechat.ts-------------------------------公众号js-sdk封装
├─ tsconfig.json-------------------------------------TypeScript 编译器的配置文件
├─ versionrc.js--------------------------------------standard-version的配置文件
├─ vite.config.ts------------------------------------用于配置 vite 的编译选项
├─ lint-staged.config.js-----------------------------用于配置 lint-staged 插件
├─ unocss.config.ts----------------------------------用于配置 unocss 原子css
└─ yarn.lock-----------------------------------------Yarn生成的锁文件，它用于记录在使用Yarn安装包时确切的依赖关系和版本号
```

#### VsCode插件
```
ESLint规范：ESLint、Prettier-ESLint、Prettier - Code formatter等三个插件；
unocss：UnoCSS等一个插件；
```

#### 项目规范
```
代码规范
ESLint + Prettier
具体可以查看https://www.yuque.com/morange/morange/gn4wgi这篇文章
```



- 安装依赖  
  - 安装前端项目依赖：`yarn `
  - 安装mock项目依赖：`yarn mock:install`
- 运行
  - 运行前端项目：`yarn dev:h5` （其他平台命令在uni-app官网或者package.json中查看）
  - 运行mock项目：`yarn mock:dev`
- 提交代码
  - 暂存准备提交的代码（举例添加当前目录下的所有文件到暂存区）：`git add .`
  - 提交：`yarn commit`，输入之后回车，我们可以选择提交类型。
- 发布版本（此处操作会使package.json中的version变更，可以此为版本号对显示）
  - 大版本升级1.0.0->2.0.0：`yarn release-major`
  - 中版本升级1.0.0->1.1.0：`yarn release-minor`
  - 小版本升级（一般是补丁）1.0.0->1.0.1：`yarn release-patch`
  - 注意：`执行完发布版本的命令之后需要将执行终端中打印的命令将生成的tag推送到git。此操作完成之后会自动生成版本发布日志，可以用于对外发布`


#### 开发提示  
- 1
```
使用typescript开发可以提高前后端交互的效率，提升前端项目的健壮性。在开发过程中需要做到尽量减少使用any。
小程序样式变量统一定义在uni.scss中，作为规范，若设计稿上使用的颜色存在于uni.scss中，则使用uni.scss中的变量，如不存在则需要沟通是否新增变量。
```

- 2 提交代码时
```
feat和fix类型的提交尽量将任务单号作为前缀方便追踪改动关联的需求，如：feat: TASK-1000 新增某个功能。git config添加了hooksPath = .husky提交钩子
所以提交代码进行了代码格式检测和提交备注检测
提交代码备注需要按照格式1/格式2提交
格式1是添加功能--feat：xxxxx
格式2是修复bug--fix：xxxxx
```